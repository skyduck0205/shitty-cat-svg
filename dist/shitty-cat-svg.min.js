!function(t){"use strict";Math.fit=function(t,e){return void 0!==e[0]&&(t=Math.max(e[0],t)),void 0!==e[1]&&(t=Math.min(e[1],t)),t},Math.randomInt=function(t,e){return Math.round(Math.random()*(e-t)+t)},Snap.plugin(function(l,t,e,n){e.prototype.circlePath=function(t,e,n){var o="M"+t+","+e;return o+="m"+-n+",0",o+="a"+n+","+n+" 0 0,1 "+2*n+",0",o+="a"+n+","+n+" 0 0,1 "+-2*n+",0",this.path(o,t,e)},t.prototype.animatePromise=function(n,o,i){var s=this;return o=void 0===o?0:o,i=void 0===i?mina.linear:i,new Promise(function(t,e){s.animate(n,o,i,t)})},l.animatePromise=function(n,o,i,s,r){return s=void 0===s?0:s,r=void 0===r?mina.linear:r,new Promise(function(t,e){l.animate(n,o,i,s,r,t)})}});var e={getCenter:function(t){return{x:t.clientWidth/2,y:t.clientHeight/2}},getDistance:function(t,e,n,o){return t-=n=void 0===n?0:n,e-=o=void 0===o?0:o,Math.pow(t*t+e*e,.5)},getInnerRatio:function(t){return(t.outer.R-t.inner.R)/(t.outer.R-t.pupil.R)}};t.ShittyCatUtils=e}(this),function(t){"use strict";function i(t,e){return function(){return c._promise===t?e():Promise.reject()}}function o(e){return new Promise(function(t){setTimeout(t,e)})}function s(t,e){e=void 0===e?200:e;var n=this.options.outer.R;return"object"==typeof t?Promise.all([this.components.leftEye.move(t.x,t.y,e),this.components.rightEye.move(t.x,t.y,e)]):s.call(this,"L"===t?{x:-n,y:0}:"R"===t?{x:n,y:0}:"T"===t?{x:0,y:-n}:"B"===t?{x:0,y:n}:"TL"===t?{x:-n,y:-n}:"TR"===t?{x:n,y:-n}:"BL"===t?{x:-n,y:n}:"BR"===t?{x:n,y:n}:{x:0,y:0},e)}function r(t){if("left"===t||"right"===t){var e=this.components[t+"Eye"];return e.moveEyelids(.85,.2,100).then(function(){return e.resetMoveEyelids.call(e,100)})}return Promise.all([r.call(this,"left"),r.call(this,"right")])}function l(e){e=void 0===e?200:e,c._promise=null;var o=this,i=["pupil","inner","reflections","eyelidTop","eyelidBottom","loadingBg","loadingCircle"],s=[];return["leftEye","rightEye"].forEach(function(t){var n=o.components[t];i.forEach(function(t){var e=n.components[t];e.stop(),e.attr({class:""})}),s=s.concat([n.resetMove(e),n.resetScalePupil(e),n.resetMoveEyelids(e),n.resetRotateEyelids(e)])}),Promise.all(s)}function a(){var e=this,n=c._promise=l.call(this).then(function t(){return o(Math.randomInt(4e3,7e3)).then(i(n,function(){return.6<Math.random()?r.call(e).then(function(){r.call(e)}):r.call(e)})).then(i(n,t)).catch(function(t){if(t)throw t})});return n}var c={_promise:null,wait:o,look:s,lookAround:function(){var t=this,e=this.options.outer.R,n=.5<Math.random()?1:-1;s.call(this,{x:.4*e*n,y:0},400).then(function(){return s.call(t,{x:.4*-e*n,y:0},800)}).then(function(){return o(800)}).then(function(){return s.call(t,"M",800)})},blink:r,spin:function(t){t=t||2;for(var r=this,e=400,l=this.components.leftEye.components.spinPath,n=l.getTotalLength(),a=ShittyCatUtils.getCenter(this.components.leftEye.svg.node),o=s.call(this,"L");t--;)o=o.then(i);return o.then(function(){return s.call(r,"M",e)});function i(){return Snap.animatePromise(0,n,function(t){var e=l.getPointAtLength(t),n=ShittyCatUtils.getInnerRatio(r.options),o=(e.x-a.x)*n+a.x,i=(e.y-a.y)*n+a.y,s=(new Snap.Matrix).translate(e.x-a.x,e.y-a.y);r.components.leftEye.components.inner.attr({cx:o,cy:i}),r.components.leftEye.components.pupil.attr({cx:e.x,cy:e.y}),r.components.leftEye.components.reflections.transform(s),r.components.rightEye.components.inner.attr({cx:o,cy:i}),r.components.rightEye.components.pupil.attr({cx:e.x,cy:e.y}),r.components.rightEye.components.reflections.transform(s)},e)}},close:function(){return Promise.all([this.components.leftEye.moveEyelids(.85,.2,200),this.components.rightEye.moveEyelids(.85,.2,200)])},open:function(){return Promise.all([this.components.leftEye.moveEyelids(0,0,200),this.components.rightEye.moveEyelids(0,0,200)])},stop:l,normal:a,angry:function(){var t=this,e=200,n=c._promise=l.call(this).then(function(){return Promise.all([t.components.leftEye.moveEyelids(.5,0,e),t.components.leftEye.rotateEyelid("top",20,e),t.components.leftEye.scalePupil(.5,1,e),t.components.rightEye.moveEyelids(.5,0,e),t.components.rightEye.rotateEyelid("top",-20,e),t.components.rightEye.scalePupil(.5,1,e)])});return t.components.leftEye.components.pupil.addClass("cat-shake"),t.components.rightEye.components.pupil.addClass("cat-shake"),n},sad:function(){var t=this,e=200,n=c._promise=l.call(this).then(function(){return Promise.all([t.components.leftEye.moveEyelids(.5,0,e),t.components.leftEye.rotateEyelid("top",-15,e),t.components.leftEye.scalePupil(1.2,1.2,e),t.components.rightEye.moveEyelids(.5,0,e),t.components.rightEye.rotateEyelid("top",15,e),t.components.rightEye.scalePupil(1.2,1.2,e)])});return t.components.leftEye.components.reflections.addClass("cat-shake"),t.components.rightEye.components.reflections.addClass("cat-shake"),n},happy:function(){var t=this,e=200,n=c._promise=l.call(this).then(function(){return Promise.all([t.components.leftEye.moveEyelids(0,.55,e),t.components.leftEye.scalePupil(.8,.8,e),t.components.rightEye.moveEyelids(0,.55,e),t.components.rightEye.scalePupil(.8,.8,e)]).then(i(n,function(){return Promise.all([t.components.leftEye.scalePupil(1.2,1.2,e),t.components.rightEye.scalePupil(1.2,1.2,e)])})).then(i(n,function(){return Promise.all([t.components.leftEye.move(10,0,e),t.components.rightEye.move(10,0,e)])})).then(i(n,function(){return Promise.all([t.components.leftEye.move(-10,0,e),t.components.rightEye.move(-10,0,e),t.components.leftEye.moveEyelids(0,.5,e),t.components.rightEye.moveEyelids(0,.5,e)])})).then(i(n,function(){return Promise.all([t.components.leftEye.resetMove(e),t.components.rightEye.resetMove(e),t.components.leftEye.moveEyelids(0,.55,e),t.components.rightEye.moveEyelids(0,.55,e)])})).catch(function(t){if(t)throw t})});return n},sleepy:function(){var e=this,n=[5e3,400,3e3,1e3],o=c._promise=l.call(this).then(function t(){return Promise.all([e.components.leftEye.moveEyelids(.65,.3,n[0],mina.elastic),e.components.rightEye.moveEyelids(.65,.3,n[0],mina.elastic)]).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.3,.2,n[1],mina.easein),e.components.rightEye.moveEyelids(.3,.2,n[1],mina.easein)])})).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.55,.3,n[2],mina.easein),e.components.rightEye.moveEyelids(.55,.3,n[2],mina.easein)])})).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.2,.2,n[3],mina.easein),e.components.rightEye.moveEyelids(.2,.2,n[3],mina.easein)])})).then(i(o,t)).catch(function(t){if(t)throw t})});return o},wake:function(){var t=this,e=[200,1200,500],n=c._promise=l.call(this).then(function(){return Promise.all([t.components.leftEye.scalePupil(.7,.7,e[0]),t.components.rightEye.scalePupil(.7,.7,e[0])]).then(i(n,function(){return o(e[1])})).then(i(n,function(){return Promise.all([t.components.leftEye.scalePupil(1,1,e[2]),t.components.rightEye.scalePupil(1,1,e[2])])})).then(i(n,function(){return a.call(t)})).catch(function(t){if(t)throw t})});return t.components.leftEye.components.reflections.addClass("cat-shake"),t.components.rightEye.components.reflections.addClass("cat-shake"),n},search:function(){var e=this,n=[200,400,300,200],o=c._promise=l.call(this).then(function t(){return Promise.all([e.components.leftEye.moveEyelids(.2,.2,n[0]),e.components.rightEye.moveEyelids(.2,.2,n[0])]).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.18,.16,n[1]),e.components.rightEye.moveEyelids(.18,.16,n[1])])})).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.19,.18,n[2]),e.components.rightEye.moveEyelids(.19,.18,n[2])])})).then(i(o,function(){return Promise.all([e.components.leftEye.moveEyelids(.18,.175,n[3]),e.components.rightEye.moveEyelids(.18,.175,n[3])])})).then(i(o,t)).catch(function(t){if(t)throw t})});return e.components.leftEye.components.loadingBg.addClass("cat-search-bg"),e.components.leftEye.components.loadingCircle.addClass("cat-search-circle"),e.components.rightEye.components.loadingBg.addClass("cat-search-bg"),e.components.rightEye.components.loadingCircle.addClass("cat-search-circle"),o}};t.ShittyCatActions=c}(this),function(t){"use strict";var e={id:"shitty-cat",color:"#000",distance:180,outer:{R:120,fill:"#FFF",stroke:"#666",strokeWidth:6},inner:{R:100,color:"#FB6:70-#F72"},pupil:{R:70,color:"#000"},faceWidth:1e3,noseWidth:80};function o(t,c){var p=this;function r(t,e){var n=ShittyCatUtils.getCenter(p.svg.node),o=c.outer.R+c.outer.strokeWidth/2+8,i=o*Math.abs(e-.5)*2;return Snap.format("M{sx},{sy}a{top.rx},{top.ry},0,0,{top.sweep},{top.x},0a{bottom.rx},{bottom.ry},0,0,{bottom.sweep},{bottom.x},0",{sx:n.x-o,sy:n.y,top:{rx:o,ry:o,sweep:"top"===t?1:0,x:2*o},bottom:{rx:o,ry:i,sweep:"top"===t?e<.5?0:1:e<.5?1:0,x:2*-o}})}this.svg=Snap(t),this.components={outer:null,inner:null,pupil:null,reflections:null,loadingBg:null,loadingCircle:null,eyelidTop:null,eyelidBottom:null,spinPath:null},this.init=function(){p.draw()},this.draw=function(){var t=ShittyCatUtils.getCenter(p.svg.node);p.components.outer=p.svg.circle(t.x,t.y,c.outer.R).attr({fill:c.outer.fill,stroke:c.outer.stroke,strokeWidth:c.outer.strokeWidth}),p.components.inner=p.svg.circle(t.x,t.y,c.inner.R).attr({fill:"r(0.5,0.5,0.5)"+c.inner.color}),p.components.pupil=p.svg.ellipse(t.x,t.y,c.pupil.R,c.pupil.R).attr({fill:c.pupil.color}),p.components.reflections=p.svg.g(p.svg.circle(t.x+c.pupil.R/2,t.y-c.pupil.R/2-10,25).attr({fill:"#FFF",fillOpacity:.9}),p.svg.circle(t.x-c.pupil.R/2,t.y+c.pupil.R/2+15,15).attr({fill:"#FFF",fillOpacity:.9})),p.components.loadingBg=p.svg.circle(t.x,t.y,25).attr({stroke:"rgba(120,220,170,.2)",strokeWidth:"0",fill:"none",strokeDasharray:156,strokeDashoffset:"0",strokeLinecap:"round"}),p.components.loadingCircle=p.svg.circle(t.x,t.y,25).attr({stroke:"#FFF",strokeWidth:"0",fill:"none",strokeDasharray:"104,156",strokeLinecap:"round",strokeDashoffset:"-52"});var e=p.svg.circle(t.x,t.y,c.outer.R-5);p.svg.g(p.components.inner,p.components.pupil,p.components.reflections,p.components.loadingBg,p.components.loadingCircle).attr({clip:e});p.components.eyelidTop=p.svg.path(r("top",0)).attr({fill:c.color}),p.components.eyelidBottom=p.svg.path(r("bottom",0)).attr({fill:c.color}),p.components.spinPath=p.svg.circlePath(t.x,t.y,.8*c.outer.R).toDefs()},this.move=function(t,e,n,o){var i=ShittyCatUtils.getInnerRatio(c);return Promise.all([p.moveInner(t*i,e*i,n,o),p.movePupil(t,e,n,o)])},this.resetMove=function(t,e){return p.move(0,0,t,e)},this.moveInner=function(t,e,n,o){var i=ShittyCatUtils.getCenter(p.svg.node),s=(ShittyCatUtils.getInnerRatio(c),ShittyCatUtils.getDistance(t,e));0!==s&&s>c.outer.R-c.inner.R&&(t=t*(c.outer.R-c.inner.R)/s,e=e*(c.outer.R-c.inner.R)/s);var r=t+i.x,l=e+i.y;return p.components.inner.animatePromise({cx:r,cy:l},n,o)},this.movePupil=function(t,e,n,o){var i=ShittyCatUtils.getCenter(p.svg.node),s=ShittyCatUtils.getDistance(t,e);0!==s&&s>c.outer.R-c.pupil.R&&(t=t*(c.outer.R-c.pupil.R)/s,e=e*(c.outer.R-c.pupil.R)/s);var r=t+i.x,l=e+i.y,a=(new Snap.Matrix).translate(t,e);return Promise.all([p.components.pupil.animatePromise({cx:r,cy:l},n,o),p.components.reflections.animatePromise({transform:a},n,o)])},this.scalePupil=function(t,e,n,o){return p.components.pupil.animatePromise({rx:c.pupil.R*t,ry:c.pupil.R*e},n,o)},this.resetScalePupil=function(t,e){return p.scalePupil(1,1,t,e)},this.moveEyelid=function(t,e,n,o){e=Math.fit(e,[0,1]);var i="top"===t?p.components.eyelidTop:p.components.eyelidBottom,s=r(t,e);return i.animatePromise({d:s},n,o)},this.moveEyelids=function(t,e,n,o){return Promise.all([p.moveEyelid("top",t,n,o),p.moveEyelid("bottom",e,n,o)])},this.resetMoveEyelids=function(t,e){return p.moveEyelids(0,0,t,e)},this.rotateEyelid=function(t,e,n,o){var i=ShittyCatUtils.getCenter(p.svg.node),s=(new Snap.Matrix).rotate(e,i.x,i.y);return("top"===t?p.components.eyelidTop:p.components.eyelidBottom).animatePromise({transform:s},n,o)},this.resetRotateEyelids=function(t,e){return Promise.all([p.rotateEyelid("top",0,t,e),p.rotateEyelid("bottom",0,t,e)])},this.init()}function s(t,r){var l=this;this.svg=Snap(t),this.components={nose:null,leftWhiskers:null,rightWhiskers:null},this.init=function(){l.draw()},this.draw=function(){n=ShittyCatUtils.getCenter(l.svg.node),o=r.noseWidth,i=.15*o,s=Snap.format("M0,0Q{top.x1},{top.y1},{top.x},{top.y}Q{right.x1},{right.y1},{right.x},{right.y}l{nbs},0Q{left.x1},{left.y1},{left.x},{left.y}",{top:{x1:o/2,y1:-20,x:o,y:0},right:{x1:o/2,y1:o/3,x:o/2+i/2,y:.75*o},left:{x1:o/2,y1:o/3,x:0,y:0},nbs:-i}),l.components.nose=l.svg.path(s).attr({class:"cat-nose",fill:"l(0,0,0,1)"+r.color+"-"+r.outer.stroke+":30-"+r.color,transform:(new Snap.Matrix).translate(n.x-r.noseWidth/2,20)}),t=Snap.format("M0,0l{w},{ly0}M0,{my1}l{w},0M0,{my2}l{w},{ly2}",{w:160,ly0:40,my1:80,my2:160,ly2:-40}),e=l.svg.path(t).attr({fill:"none",stroke:"l(0,0,1,0)"+r.color+"-"+r.outer.stroke+":30-"+r.outer.stroke+":70-"+r.color,strokeWidth:6}).toDefs(),l.components.leftWhiskers=l.svg.use(e).attr({transform:(new Snap.Matrix).translate(20,10)}),l.components.rightWhiskers=l.svg.use(e).attr({transform:(new Snap.Matrix).translate(l.svg.node.clientWidth-20,10).scale(-1,1)});var t,e;var n,o,i,s},this.init()}var n=new function(){var i=this;this.components={leftEye:null,rightEye:null,mouth:null},this.options=_.cloneDeep(e),this.actions={},this.init=function(t){_.merge(i.options,_.cloneDeep(t)),i.draw(),ShittyCatActions&&i.loadActions(ShittyCatActions)},this.draw=function(){var t=document.getElementById(i.options.id);t.classList.add("shitty-cat"),t.style.backgroundColor=i.options.color,t.style.textAlign="center";var e=document.createElement("div");t.appendChild(e);var n=2*i.options.outer.R+i.options.outer.strokeWidth;Snap(n,n).attr({class:"cat-eye-left"}).appendTo(e),Snap(n,n).attr({class:"cat-eye-right"}).appendTo(e).node.style.marginLeft=i.options.distance,Snap(i.options.faceWidth,180).attr({class:"cat-mouth"}).appendTo(t),i.components.leftEye=new o("#"+i.options.id+" .cat-eye-left",i.options),i.components.rightEye=new o("#"+i.options.id+" .cat-eye-right",i.options),i.components.mouth=new s("#"+i.options.id+" .cat-mouth",i.options)},this.loadActions=function(e){Object.getOwnPropertyNames(e).forEach(function(t){"function"==typeof e[t]&&(i.actions[t]=e[t].bind(i))})},this.miniMode=function(t,e){var n=(e=e||60)/i.options.outer.R,o=document.getElementById(i.options.id);t?(o.classList.add("cat-mini"),o.style.height=2*e+i.options.outer.strokeWidth*n+"px",i.components.rightEye.svg.node.style.marginLeft=i.options.distance*n,i.components.leftEye.svg.transform((new Snap.Matrix).scale(n)),i.components.rightEye.svg.transform((new Snap.Matrix).scale(n)),i.components.mouth.svg.transform((new Snap.Matrix).scale(1,n))):(o.classList.remove("cat-mini"),o.style.height="",i.components.rightEye.svg.node.style.marginLeft=i.options.distance,i.components.leftEye.svg.transform((new Snap.Matrix).scale(1)),i.components.rightEye.svg.transform((new Snap.Matrix).scale(1)),i.components.mouth.svg.transform((new Snap.Matrix).scale(1,1)))},this.destroy=function(){document.getElementById(i.options.id).innerHTML=""}};t.ShittyCat=n}(this);
//# sourceMappingURL=shitty-cat-svg.min.js.map
